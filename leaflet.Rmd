---
title: "Leaflet.js"
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    theme: flatly
---

$~$

# Basics of Leaflet.js


[Leaflet.js](http://leafletjs.com/) is an open-source JavaScript library used for the creation of interactive, simple and lightweight web maps. Leaflet forms the basis of [Mapbox.js](https://www.mapbox.com/mapbox.js/api/v3.1.1/). 

You can create a web map either using a text editor on your PC, or an online code editor. 

$~$

## Text editor

One example of a text editor is [Atom](https://atom.io/) which is available for free to download.

Using a text editor, the first step of creating a web map starts with the **HTML page**.


    <html>

      <head>

        <style>
        
        </style>

      </head>

      <body>

        <script>

        </script>

      </body>

    </html>


This is the basic set up of a HTML page.

The next step is integrating the **Leaflet CSS** and **Leaflet.js** scripts. You can access the hosted version [here](http://leafletjs.com/download.html).

Both files will sit in the head section of the HTML code. Make sure to keep the order.


    <html>

      <head>

        <link rel = "stylesheet" href = "http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />

        <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

        <style>

        </style>

      </head>

        <body>

          <script>

          </script>

        </body>

      </html>
    

Then, create a container for the map defining the dimensions. This will sit in the body section.


    <html>

      <head>

        <link rel = "stylesheet" href = "http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />

        <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

        <style>

        </style>

      </head>

        <body>

          <div id = "map" style = "width: 100%; height: 100%"></div>

          <script>

          </script>

        </body>

    </html>

$~$

## Online code editor

Let's look into how you can use leaflet.js on [jsFiddle](https://jsfiddle.net/), an online code editor used to test your JavaScript, CSS, HTML.

After registering on jsFiddle, start with a blank workspace.

![](http://marinespatialviz.github.io/marinespatialviz/images/jsfiddle.png)
$~$

The first step here is to add leaflet.js and leaflet.css as an external resource.

Click on External Resources and add these two web addresses:

https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css

https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js

![](http://marinespatialviz.github.io/marinespatialviz/images/jsfiddle1.png)
$~$

Before going further, let's discuss the terms: 

HTML (HypterText Markup Language): provides the content of the web page that can be structured.

CSS (Cascading Style Sheets): gives control over the style and visual presentation of the web page.

JS (JavaScript): this will give the web page interactivity.

$~$

Now using the previous example, let's add the HTML, CSS and JavaScript elements.

HTML (will not need the whole HTML code):

    <div id="map"></div>

CSS (the width and height is adjusted to the size of the preview window):

    #map {height: 420px}
    
JavaScript:

    var map = L.map('map',{center: [20, -15],zoom: 3});

    L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);
    
    
<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/embed/js,html,css,result/dark/"></script>

$~$


**In the examples below both text editor and jsFiddle codes are displayed.**


$~$

# View and basemap

Now, let's construct the body adding the map object. The view can be set using `var map = L.map('map', {center: [20, -15], zoom: 3});` and just like in in R Studio, different [basemaps](https://leaflet-extras.github.io/leaflet-providers/preview/) can be used. 


    <html>

      <head>

        <link rel = "stylesheet" href = "http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />

        <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

        <style>

        </style>

      </head>

        <body>

          <div id = "map" style = "width: 100%; height: 100%"></div>

          <script>

          var map = L.map('map',{
          center: [20, -15],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          </script>

        </body>

    </html>

<script async src=https:"//jsfiddle.net/WandaBodnar/2eton50g/1/embed/js,html,css,result/dark/"></script>

$~$

# Marker

With the marker variable `var marker = L.marker ([x, y])` the coordinates will be given and it will be added to the map `marker.addTo()`.

          <script>

          var map = L.map('map',{
          center: [11, 142],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var marker = L.marker([11.3499986, 142.1999992])
          marker.addTo(map);

          </script>

<script async src="https://jsfiddle.net/WandaBodnar/Lvgjye3n/1/embed/js,html,css,result/dark/"></script>

$~$

## Pop-up marker

Let's add a pop-up with text to the marker.

          <script>
          
          var map = L.map('map',{
          center: [11, 142],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);
          
          var marker = L.marker([11.3499986, 142.1999992])

          marker.bindPopup('Mariana Trench').openPopup();
          
          marker.addTo(map);
          
          </script>
          
Here is another option. 

          <script>
        
          var map = L.map('map',{
          center: [11, 142],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);
          
          var marker = L.marker([11.3499986, 142.1999992]).bindPopup('Mariana Trench')

          marker.addTo(map);

          </script>

<script async src="https://jsfiddle.net/WandaBodnar/2tbp9cL5/1/embed/js,html,css,result/dark/"></script>

$~$

## Circle marker

Here is the code for adding a circle. 

          <script>

          var map = L.map('map',{
          center: [11, 142],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var circle = L.circle([11.3499986, 142.1999992], 100000, {
          color: '#a58fa4',
          fillColor: '#0d11ee',
          fillOpacity: 0.5}).addTo(map);

          map.addLayer(circle);

<script async src="https://jsfiddle.net/WandaBodnar/2tbp9cL5/2/embed/js,html,css,result/dark/"></script>

$~$

## Costum marker

Let's also add the submarine to the map. 

          <script>

          var map = L.map('map',{
          center: [11, 142],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var customIcon = L.icon({
          iconUrl: 'https://image.flaticon.com/icons/png/512/190/190006.png',
          iconSize: [100, 95]});

          var marker = L.marker([11.3499986, 142.1999992], {icon: customIcon})

          marker.addTo(map);

          </script>
    
<script async src="https://jsfiddle.net/WandaBodnar/2tbp9cL5/3/embed/js,html,css,result/dark/"></script>

$~$

# Polyline

Let's see how we can add a line between two points (in this case The Equator).

Here, the `var line = ()` was defined and was added to the map.

          <script>

          var map = L.map('map',{
          center: [0, 0],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var line = L.polyline([[0, -180], [0, 180]],{color: 'red'}).addTo(map);

          </script>

<script async src="https://jsfiddle.net/WandaBodnar/2tbp9cL5/5/embed/js,html,css,result/dark/"></script>

$~$

# Polygon

A polygon can be added using the `var polygon = L.polygon()`

          <script>

          var map = L.map('map',{
          center: [0, 0],
          zoom: 3
          });

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var polygon = L.polygon([[23.5, 180], [-23.5, 180], [-23.5, -180], [23.5, -180]],
          {color: 'orange', fillColor: 'orange', fillOpacity: .5}).addTo(map);

          map.addLayer(polygon);

          </script>
          
<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/2/embed/js,html,css,result/dark/"></script>

$~$

# Layer control

The layer control can be added by defining the choosen basemap and adding the control function.

          <script>

          var map = L.map('map',{
          center: [0, 0],
          zoom: 2
          });

          var Hydda_Full = L.tileLayer('https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png', {
          maxZoom: 18,
          attribution: 'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <ahref="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          var CartoDB_DarkMatter = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
          subdomains: 'abcd',
          maxZoom: 19
          }).addTo(map);
          
          L.control.layers({
          'Hydda': Hydda_Full,
          'Carto': CartoDB_DarkMatter
          }).addTo(map);

          </script>

<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/3/embed/js,html,css,result/dark/"></script>

$~$

## Layer control with icon

          <script>
 
          var dolphinIcon = L.icon({
          iconUrl: 'https://image.flaticon.com/icons/svg/47/47327.svg',
          iconSize: [32, 37]
          });

          var sealIcon = L.icon({
          iconUrl: 'https://d30y9cdsu7xlg0.cloudfront.net/png/56283-200.png',
          iconSize: [32, 37]
          });

          var dolphinLayer = L.marker([51.4709, -0.221], {icon: dolphinIcon});

          var sealLayer = L.marker([51.4701, -0.1801], {icon: sealIcon});

          var map = L.map('map', {
          center: [51.47, -0.20],
          zoom: 13,
          layers: [dolphinLayer, sealLayer]
          });

          var overlayMaps = {
          "<img src='https://image.flaticon.com/icons/svg/47/47327.svg' height=21>Dolphin": dolphinLayer,
          "<img src='https://d30y9cdsu7xlg0.cloudfront.net/png/56283-200.png' height=21>Seal": sealLayer
          };

          L.control.layers(null, overlayMaps, {
          collapsed: false
          }).addTo(map);

          var CartoDB_Positron = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
          subdomains: 'abcd',
          maxZoom: 19
          }).addTo(map);
          
          </script>

<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/4/embed/js,html,css,result/dark/"></script>

$~$

# WMS tile

Web Map Sevices tile can be added using the `L.tileLayer.wms()` function. 

          <script>

          var map = L.map('map',{
          center: [51.5, -0.11],
          zoom: 4
          });

          L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>contributors'
          }).addTo(map);
          
          L.tileLayer.wms("http://213.122.160.75/scripts/mapserv.exe?map=D:/Websites/MeshAtlantic/map/MESHAtlantic.map", {
    	    layers: 'EUSMMSFD',
    	    format: 'image/png',
          transparent: true,
          attribution: '&copy; <a href="http://www.emodnet.eu/">EUSeaMap2 2016 Broad-Scale Predictive Habitat Map</a>'
          }).addTo(map);

          </script>
          
<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/5/embed/js,html,css,result/dark/"></script>

$~$

#Showing coordinate information

          <script>

          var map = L.map('map', {center: [20, -15],zoom: 2});

          L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
          }).addTo(map);

          var popup = L.popup();

          function onMapClick(e) {
          popup
          .setLatLng(e.latlng)
          .setContent(e.latlng.toString())
          .openOn(map);
          }

          map.on('click', onMapClick);

          </script>
          
<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/9/embed/js,html,css,result/dark/"></script>

$~$

# Adding geotagged pictures to a map

          <script>

          var map = L.map('map', {
          center: [20, -15],
          zoom: 2
          });

          var CartoDB_DarkMatter = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
          subdomains: 'abcd',
          maxZoom: 19
          }).addTo(map);

          var customPopup = "Oarai beach<br/><img src='https://c1.staticflickr.com/5/4435/36028473794_62c4e88482_b.jpg' width='300px'/>";
          var marker = L.marker([36.29, 140.56]).
          bindPopup(customPopup).addTo(map);

          var customPopup = "Santa Monica<br/><img src='https://c1.staticflickr.com/5/4364/36053908023_67500b4bd6_b.jpg' width='300px'/>";
          var marker = L.marker([34.00, -118.49]).
          bindPopup(customPopup).addTo(map);  

          var customPopup = "Bondi beach<br/><img src='https://c1.staticflickr.com/5/4440/36862734845_8c485429e7_b.jpg' width='300px'/>";
          var marker = L.marker([-33.89, 151.28]).
          bindPopup(customPopup).addTo(map);

          var customPopup = "West Wittering<br/><img src='https://c1.staticflickr.com/5/4391/36054414233_b3f762af22_b.jpg' width='300px'/>";
          var marker = L.marker([50.76, -0.90]).
          bindPopup(customPopup).addTo(map);

          </script>
          
<script async src="https://jsfiddle.net/WandaBodnar/Lb951bdj/13/embed/js,html,css,result/dark/"></script>

$~$

# Adding a marker

          <script>
          
          var map = L.map('map', {center: [20, -15],zoom: 2});

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);

          newMarkerGroup = new L.LayerGroup();
          map.on('click', function(e){var newMarker = new L.marker(e.latlng).addTo(map);});
    
          </script>

<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/18/embed/js,html,css,result/dark/"></script>

$~$

# Home button

Extentions to use: 

* https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css

* https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js

* https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css


          <script>
          
          var map = L.map('map', {center: [51.6, -0.3], zoom: 9});

          L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }).addTo(map);
          
          var home = {
                  lat: 51.6,
                  lng: -0.3,
                  zoom: 9
                  };
          L.easyButton('<i class="fa fa-home" style="font-size:15px;"></i>', function(){
            map.setView([home.lat, home.lng], home.zoom);
          },'Zoom To Home').addTo(map);
    
          L.control.locate().addTo(map);
    
          </script>
          
<script async src="https://jsfiddle.net/WandaBodnar/2eton50g/21/embed/js,html,css,result/dark/"></script>

$~$

<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>